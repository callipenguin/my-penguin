import{u as be,a as g,a9 as ie,j as f,B as R,T as F}from"./mui-ea599dee.js";import{V as xe,a as de,S as Pe,C as Se,P as Re,W as ze,b as ve,A as Ge,D as Ce,M as c,R as je,G as O,c as b,d as m,e as ke,f as q,g as Ee,B as Ie,h as Fe,i as Be,j as Ae}from"./three-71825040.js";import"./dayjs-9d6a636c.js";const Xe=({width:v=800,height:G=400,projects:B=[]})=>{const A=be().palette.mode==="dark",x=g.useRef(null),S=g.useRef(),P=g.useRef(),y=g.useRef(),M=g.useRef([]),L=g.useRef(),C=g.useRef(),j=g.useRef([]),U=g.useRef(new xe(0,0)),T=g.useRef(new de(0,0,0)),[W,Y]=ie.useState(!1),[d,K]=ie.useState(null),ue=o=>{if(!x.current||!y.current||!S.current)return;const e=x.current.getBoundingClientRect(),t=(o.clientX-e.left)/e.width*2-1,a=-((o.clientY-e.top)/e.height)*2+1;U.current.set(t,a);const n=new de(t,a,.5);n.unproject(y.current);const s=n.sub(y.current.position).normalize(),r=-y.current.position.y/s.y,l=y.current.position.clone().add(s.multiplyScalar(r));T.current.copy(l);const p=new je;p.setFromCamera(U.current,y.current);const h=[];M.current.forEach(u=>{u.children.forEach(w=>{w instanceof c&&(w.userData.penguin=u,h.push(w))})});const i=p.intersectObjects(h);if(i.length>0){const u=i[0].object.userData.penguin;K(u.userData.project)}else K(null)},le=()=>{Y(!0)},pe=()=>{Y(!1)},N=(o,e)=>{switch(o){case"planning":return{body:2894892,accent:16747520};case"active":return{body:e>70?3046706:2894892,accent:16747520};case"paused":return{body:7697781,accent:16747520};case"completed":return{body:3046706,accent:16747520};case"cancelled":return{body:13840175,accent:16747520};default:return{body:2894892,accent:16747520}}},Q=(o,e)=>{const t=new O,a=new b(.6,32,16);a.scale(1,1.5,1);const n=new m({color:16777215,roughness:.7,metalness:.05}),s=new c(a,n);s.position.y=1.2,s.castShadow=!0,t.add(s);const r=new b(.55,32,16);r.scale(1,1.6,.8);const l=new m({color:o.body,roughness:.8,metalness:.1}),p=new c(r,l);p.position.set(0,1.3,-.2),p.castShadow=!0,t.add(p);const h=new ke(.25,.28,.3,16),i=new m({color:o.body,roughness:.8,metalness:.1}),u=new c(h,i);u.position.y=1.8,u.castShadow=!0,t.add(u);const w=new b(.32,32,16),H=new m({color:o.body,roughness:.8,metalness:.1}),z=new c(w,H);z.position.y=2.1,z.castShadow=!0,t.add(z);const X=new b(.15,16,8);X.scale(.4,1.2,.2);const $=new m({color:o.body,roughness:.8,metalness:.1}),k=new c(X,$);k.position.set(-.5,1.2,-.1),k.rotation.z=.3,k.castShadow=!0,t.add(k);const E=new c(X,$);E.position.set(.5,1.2,-.1),E.rotation.z=-.3,E.castShadow=!0,t.add(E);const ye=new q(.06,.25,8),Me=new m({color:o.accent,roughness:.3,metalness:.2}),I=new c(ye,Me);I.position.set(0,2.1,.4),I.rotation.x=Math.PI/2,I.castShadow=!0,t.add(I);const D=new b(.08,16,16),ee=new m({color:16777215,roughness:.1,metalness:.1}),te=new c(D,ee);te.position.set(-.15,2.15,.25),t.add(te);const ne=new c(D,ee);ne.position.set(.15,2.15,.25),t.add(ne);const oe=new b(.04,16,16),se=new m({color:0,roughness:.1,metalness:.8}),re=new c(oe,se);re.position.set(-.15,2.15,.3),t.add(re);const ae=new c(oe,se);ae.position.set(.15,2.15,.3),t.add(ae);const Z=new b(.12,16,8);Z.scale(1.5,.3,1);const ce=new m({color:o.accent,roughness:.4,metalness:.1}),V=new c(Z,ce);V.position.set(-.2,.12,.3),V.castShadow=!0,t.add(V);const J=new c(Z,ce);return J.position.set(.2,.12,.3),J.castShadow=!0,t.add(J),t},he=()=>{const o=new O;for(let e=0;e<8;e++){const t=new q(.5+Math.random()*1.5,1.5+Math.random()*2,6+Math.floor(Math.random()*4)),a=new m({color:15135743,roughness:.8,metalness:.1,transparent:!0,opacity:.9}),n=new c(t,a),s=e/8*Math.PI*2,r=8+Math.random()*6;n.position.x=Math.sin(s)*r,n.position.z=Math.cos(s)*r,n.position.y=.3,n.rotation.y=Math.random()*Math.PI*2,n.rotation.z=(Math.random()-.5)*.3,n.castShadow=!0,n.receiveShadow=!0,o.add(n)}return o},me=()=>{const o=new Ee(50,50),e=new m({color:27028,roughness:.8,metalness:.3,transparent:!0,opacity:.7}),t=new c(o,e);return t.rotation.x=-Math.PI/2,t.position.y=-.1,t.receiveShadow=!0,t},we=()=>{const e=new Ie,t=new Float32Array(200*3);for(let n=0;n<200*3;n+=3)t[n]=(Math.random()-.5)*40,t[n+1]=Math.random()*20,t[n+2]=(Math.random()-.5)*40;e.setAttribute("position",new Fe(t,3));const a=new Be({color:16777215,size:.1,transparent:!0,opacity:.6});return new Ae(e,a)},ge=()=>{const o=new O,e=new b(.08,16,16);e.scale(1.5,1,1);const t=new m({color:5227511,roughness:.3,metalness:.2}),a=new c(e,t);o.add(a);const n=new q(.04,.12,4),s=new m({color:2733814,roughness:.3}),r=new c(n,s);return r.position.set(-.12,0,0),r.rotation.y=Math.PI/2,o.add(r),o.scale.setScalar(.8),o},fe=o=>{var n;if(j.current.length>5)return;const e=ge(),t=o.clone();t.x+=(Math.random()-.5)*2,t.z+=(Math.random()-.5)*2,t.y=-.1;const a=t.clone();a.x+=(Math.random()-.5)*3,a.z+=(Math.random()-.5)*3,a.y=-.1,e.position.copy(t),(n=S.current)==null||n.add(e),j.current.push({mesh:e,startTime:Date.now(),startPos:t,targetPos:a,duration:2e3+Math.random()*1e3})};g.useEffect(()=>{if(!x.current)return;const o=new Pe;o.background=new Se(A?1712172:15792383),S.current=o;const e=new Re(75,v/G,.1,1e3);e.position.set(0,6,12),e.lookAt(0,0,0),y.current=e;const t=new ze({antialias:!0});t.setSize(v,G),t.shadowMap.enabled=!0,t.shadowMap.type=ve,P.current=t,x.current.appendChild(t.domElement);const a=new Ge(16777215,.8);o.add(a);const n=new Ce(16777215,.6);n.position.set(10,10,5),n.castShadow=!0,n.shadow.mapSize.width=2048,n.shadow.mapSize.height=2048,o.add(n);const s=B.length>0?B:[],r=[];if(s.length>0)s.forEach((i,u)=>{const w=Q(N(i.status,i.progress));w.userData={project:i,index:u},r.push(w),o.add(w)});else{const i={id:"default",title:"첫 번째 프로젝트를 시작해보세요!",status:"planning",progress:0,tasks:[]},u=Q(N(i.status,i.progress));u.userData={project:i,index:0},r.push(u),o.add(u)}M.current=r;const l=he();o.add(l);const p=me();o.add(p);const h=we();return o.add(h),C.current=h,_(),()=>{L.current&&cancelAnimationFrame(L.current),x.current&&P.current&&x.current.removeChild(P.current.domElement),P.current&&P.current.dispose()}},[v,G,B,A]);const _=()=>{if(L.current=requestAnimationFrame(_),M.current.length>0&&S.current&&P.current&&y.current){const o=Date.now()*.001;if(M.current.forEach((e,t)=>{const a=e.userData.project,n=e.userData.index;if(a.status==="active"&&e.children.forEach(s=>{if(s instanceof c){const r=s.material,l=r.color.getHex();if(l!==16777215&&l!==16747520){const p=(o*.5+n*.3)%1;r.color.setHSL(p,.8,.4)}}}),W){const s=T.current.x,r=T.current.z,l=Math.sin(n*2.1)*1.5,p=Math.cos(n*2.1)*1.5,h=s+l,i=r+p,u=.02;e.position.x+=(h-e.position.x)*u,e.position.z+=(i-e.position.z)*u;const w=h-e.position.x,H=i-e.position.z,z=Math.atan2(w,H);e.rotation.y+=(z-e.rotation.y)*.05,e.position.y=Math.abs(Math.sin(o*3+n))*.03}else{const s=.3+n*.1,r=2.5+n*.8,l=n*Math.PI*2/M.current.length,p=Math.sin(o*s+l)*r,h=Math.cos(o*s+l)*r;e.position.x=p+Math.sin(o*2+n)*.3,e.position.z=h+Math.cos(o*2+n)*.3,e.rotation.y=-o*s+l+Math.PI/2,e.position.y=Math.abs(Math.sin(o*4+n))*.05}}),C.current){const e=C.current.geometry.attributes.position.array;for(let t=1;t<e.length;t+=3)e[t]-=.01,e[t]<0&&(e[t]=20);C.current.geometry.attributes.position.needsUpdate=!0}if(j.current=j.current.filter(e=>{var i;const a=(Date.now()-e.startTime)/e.duration;if(a>=1)return(i=S.current)==null||i.remove(e.mesh),!1;const n=a,s=e.startPos.x+(e.targetPos.x-e.startPos.x)*n,r=e.startPos.z+(e.targetPos.z-e.startPos.z)*n,l=-.1+Math.sin(n*Math.PI)*1.5;e.mesh.position.set(s,l,r);const p=e.targetPos.x-e.startPos.x,h=e.targetPos.z-e.startPos.z;return e.mesh.rotation.y=Math.atan2(p,h),!0}),Math.random()<.005&&M.current.length>0){const e=M.current[Math.floor(Math.random()*M.current.length)];fe(e.position)}P.current.render(S.current,y.current)}};return f.jsxs(R,{ref:x,sx:{width:v,height:G,borderRadius:4,overflow:"hidden",boxShadow:"0 12px 40px rgba(0, 0, 0, 0.15)",border:"2px solid rgba(33, 150, 243, 0.2)",background:A?"linear-gradient(135deg, #1a202c 0%, #2d3748 100%)":"linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)",position:"relative",cursor:W?"pointer":"default","& canvas":{borderRadius:4}},onMouseMove:ue,onMouseEnter:le,onMouseLeave:pe,children:[!W&&!d&&f.jsx(R,{sx:{position:"absolute",top:16,left:16,backgroundColor:"rgba(255, 255, 255, 0.9)",borderRadius:2,px:2,py:1,fontSize:"0.8rem",color:"text.secondary",pointerEvents:"none",transition:"opacity 0.3s ease"},children:"🐧 마우스를 올려보세요!"}),d&&f.jsxs(R,{sx:{position:"absolute",top:16,left:16,backgroundColor:"rgba(255, 255, 255, 0.95)",borderRadius:3,px:3,py:2,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)",border:"2px solid rgba(33, 150, 243, 0.3)",pointerEvents:"none",zIndex:10,maxWidth:300},children:[f.jsxs(R,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[f.jsxs(R,{sx:{fontSize:"1.2rem"},children:[d.status==="planning"&&"🧊",d.status==="active"&&"🌈",d.status==="paused"&&"❄️",d.status==="completed"&&"🐟",d.status==="cancelled"&&"🔴"]}),f.jsx(F,{variant:"h6",fontWeight:"bold",sx:{fontSize:"1rem"},children:d.title})]}),f.jsx(F,{variant:"body2",color:"text.secondary",sx:{mb:1,fontSize:"0.8rem"},children:d.description}),f.jsxs(R,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsxs(F,{variant:"caption",sx:{px:1.5,py:.5,borderRadius:1,backgroundColor:d.status==="active"?"primary.main":"grey.300",color:d.status==="active"?"white":"text.primary",fontSize:"0.7rem",fontWeight:"bold"},children:[d.status==="planning"&&"계획중",d.status==="active"&&"진행중 🌈",d.status==="paused"&&"일시정지",d.status==="completed"&&"완료",d.status==="cancelled"&&"취소"]}),f.jsxs(F,{variant:"caption",sx:{fontWeight:"bold",fontSize:"0.8rem"},children:[d.progress,"%"]})]})]})]})};export{Xe as default};
