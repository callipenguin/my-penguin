import{u as Q,a as g,j as t,B as n,T as l,f as p,aM as H,G as M,a6 as W,a7 as Y,C as V,aN as Z,Y as ee,J as te,D as oe,b as re,c as ae,aO as se,d as ne,e as ie}from"./mui-ea599dee.js";import{d as j}from"./dayjs-9d6a636c.js";import{g as U,l as le,s as de}from"./index-a725ad54.js";const ue=({themeConfig:u})=>{var O;const r=Q(),[x,D]=g.useState(j().startOf("week")),[f,m]=g.useState([]),[d,v]=g.useState(null),[G,b]=g.useState(!1),[w,S]=g.useState(""),C=(()=>{switch(u==null?void 0:u.id){case"desert-fox":return{excellent:"ðŸ¦Š",good:"ðŸŒµ",normal:"â˜€ï¸",tired:"ðŸœï¸",exhausted:"ðŸ”¥"};case"sheep":return{excellent:"ðŸ‘",good:"ðŸŒ¿",normal:"ðŸŒ±",tired:"ðŸƒ",exhausted:"ðŸŒ¾"};case"cat":return{excellent:"ðŸ±",good:"ðŸŸ",normal:"ðŸ§¶",tired:"ðŸ¾",exhausted:"ðŸ˜¿"};default:return{excellent:"ðŸ§",good:"ðŸŸ",normal:"â„ï¸",tired:"ðŸ§Š",exhausted:"ðŸ»â€â„ï¸"}}})(),y=[{level:"excellent",emoji:C.excellent,color:"#4caf50",label:"ìµœê³ "},{level:"good",emoji:C.good,color:"#8bc34a",label:"ì¢‹ìŒ"},{level:"normal",emoji:C.normal,color:"#ffc107",label:"ë³´í†µ"},{level:"tired",emoji:C.tired,color:"#ff9800",label:"í”¼ê³¤"},{level:"exhausted",emoji:C.exhausted,color:"#f44336",label:"ë§¤ìš° í”¼ê³¤"}],J=Array.from({length:24},(e,o)=>o),B=Array.from({length:7},(e,o)=>x.add(o,"day")),I=e=>[r.palette.error.main+"08",r.palette.info.main+"08",r.palette.success.main+"08",r.palette.warning.main+"08",r.palette.secondary.main+"08",r.palette.primary.main+"08",r.palette.grey[500]+"08"][e]||r.palette.grey[100],h=e=>[r.palette.error.main,r.palette.info.main,r.palette.success.main,r.palette.warning.main,r.palette.secondary.main,r.palette.primary.main,r.palette.grey[600]][e]||r.palette.text.primary;g.useEffect(()=>{N()},[x]);const N=async()=>{try{const e=U();if(e){const o=await le(e.uid,"conditions");o.success&&o.data?m(o.data):m([])}else{const o=localStorage.getItem("conditions");m(o?JSON.parse(o):[])}}catch(e){console.error("ì»¨ë””ì…˜ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:",e),m([])}},T=async e=>{try{const o=U();o?await de(o.uid,"conditions",e):localStorage.setItem("conditions",JSON.stringify(e))}catch(o){console.error("ì»¨ë””ì…˜ ë°ì´í„° ì €ìž¥ ì‹¤íŒ¨:",o)}},$=(e,o)=>f.find(a=>a.date===e&&a.hour===o),F=(e,o,a)=>{v({date:e,hour:o}),S((a==null?void 0:a.memo)??""),b(!0)},_=async e=>{if(!d)return;const o=$(d.date,d.hour);let a;if(o)a=f.map(i=>i.id===o.id?{...i,condition:e,memo:w,updatedAt:new Date().toISOString()}:i);else{const i={id:Date.now().toString(),date:d.date,hour:d.hour,condition:e,memo:w,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};a=[...f,i]}m(a),await T(a),b(!1),v(null),S("")},L=async()=>{if(!d)return;const e=$(d.date,d.hour);if(e){const o=f.map(a=>a.id===e.id?{...a,memo:w,updatedAt:new Date().toISOString()}:a);m(o),await T(o)}b(!1),v(null),S("")},k=e=>y.find(o=>o.level===e),X=(e,o)=>{const a=o!==void 0?I(o):"transparent";if(!e)return a;const i=k(e.condition);return i?`linear-gradient(135deg, ${i.color}30, ${a})`:a},q=()=>{const e=x.format("YYYY-MM-DD"),o=x.add(6,"day").format("YYYY-MM-DD"),a=f.filter(s=>s.date>=e&&s.date<=o),i=y.reduce((s,c)=>(s[c.level]=a.filter(A=>A.condition===c.level).length,s),{});return{weekConditions:a,conditionCounts:i}},{weekConditions:K,conditionCounts:P}=q();return t.jsxs(n,{sx:{p:3},children:[t.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[t.jsxs(n,{children:[t.jsx(l,{variant:"h4",fontWeight:"bold",gutterBottom:!0,children:"ðŸ’š ì»¨ë””ì…˜ ì²´í¬"}),t.jsxs(l,{variant:"body1",color:"textSecondary",children:[((O=u==null?void 0:u.concepts)==null?void 0:O.animal)||"ë™ë¬¼","ì²˜ëŸ¼ ì‹œê°„ë³„ ì»¨ë””ì…˜ì„ ê¸°ë¡í•˜ê³  íŒ¨í„´ì„ ë¶„ì„í•´ë³´ì„¸ìš”"]})]}),t.jsxs(n,{sx:{display:"flex",gap:2},children:[t.jsx(p,{startIcon:t.jsx(H,{}),onClick:()=>D(x.subtract(1,"week")),children:"ì´ì „ ì£¼"}),t.jsx(p,{variant:"contained",onClick:()=>D(j().startOf("week")),children:"ì´ë²ˆ ì£¼"}),t.jsx(p,{startIcon:t.jsx(H,{}),onClick:()=>D(x.add(1,"week")),children:"ë‹¤ìŒ ì£¼"})]})]}),t.jsxs(M,{container:!0,spacing:3,sx:{mb:4},children:[t.jsx(M,{item:!0,xs:12,md:8,children:t.jsx(W,{children:t.jsxs(Y,{children:[t.jsxs(l,{variant:"h6",fontWeight:"bold",gutterBottom:!0,children:["ðŸ“Š ì´ë²ˆ ì£¼ í†µê³„ (",x.format("MM/DD")," - ",x.add(6,"day").format("MM/DD"),")"]}),t.jsx(n,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:y.map(e=>t.jsx(V,{label:`${e.emoji} ${e.label}: ${P[e.level]}íšŒ`,sx:{bgcolor:e.color+"20",color:e.color,fontWeight:500}},e.level))}),t.jsxs(l,{variant:"body2",color:"textSecondary",sx:{mt:2},children:["ì´ ",K.length,"ê°œì˜ ì»¨ë””ì…˜ì´ ê¸°ë¡ë˜ì—ˆìŠµë‹ˆë‹¤"]})]})})}),t.jsx(M,{item:!0,xs:12,md:4,children:t.jsx(W,{children:t.jsxs(Y,{sx:{textAlign:"center"},children:[t.jsx(Z,{sx:{fontSize:40,color:r.palette.primary.main,mb:1}}),t.jsx(l,{variant:"h6",gutterBottom:!0,children:"ì£¼ê°„ í‰ê· "}),t.jsx(l,{variant:"h4",color:"primary",children:"3.2/5"}),t.jsx(p,{size:"small",startIcon:t.jsx(ee,{}),sx:{mt:1},children:"ë¶„ì„ ë³´ê¸°"})]})})})]}),t.jsx(W,{children:t.jsxs(Y,{children:[t.jsx(l,{variant:"h6",fontWeight:"bold",gutterBottom:!0,children:"ðŸ—“ï¸ ì‹œê°„ë³„ ì»¨ë””ì…˜ ê·¸ë¦¬ë“œ"}),t.jsx(n,{sx:{display:"flex",gap:1,mb:3,flexWrap:"wrap"},children:y.map(e=>t.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:.5},children:[t.jsx(n,{sx:{width:16,height:16,backgroundColor:e.color+"30",border:`2px solid ${e.color}`,borderRadius:1}}),t.jsxs(l,{variant:"caption",children:[e.emoji," ",e.label]})]},e.level))}),t.jsx(n,{sx:{overflowX:"auto",position:"relative",maxHeight:"70vh",overflowY:"auto"},children:t.jsxs(n,{sx:{minWidth:800},children:[t.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"80px repeat(7, 1fr)",gap:1,mb:1,position:"sticky",top:0,backgroundColor:r.palette.background.paper,zIndex:10,borderBottom:`2px solid ${r.palette.divider}`,pb:1},children:[t.jsx(n,{sx:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",backgroundColor:r.palette.grey[100],borderRadius:1,border:`1px solid ${r.palette.divider}`},children:t.jsx(l,{variant:"caption",fontWeight:"bold",children:"ì‹œê°„"})}),B.map((e,o)=>t.jsxs(n,{sx:{textAlign:"center",p:1.5,backgroundColor:I(o),borderRadius:2,border:`2px solid ${h(o)}30`,boxShadow:1},children:[t.jsx(l,{variant:"body2",fontWeight:"bold",sx:{color:h(o)},children:e.format("ddd")}),t.jsx(l,{variant:"caption",sx:{color:h(o),opacity:.8,display:"block",mt:.5},children:e.format("MM/DD")}),e.isSame(j(),"day")&&t.jsx(n,{sx:{width:6,height:6,backgroundColor:h(o),borderRadius:"50%",mx:"auto",mt:.5}})]},e.format("YYYY-MM-DD")))]}),J.map(e=>t.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"80px repeat(7, 1fr)",gap:1,mb:1,"&:hover":{"& > div":{transform:"scale(1.01)",transition:"transform 0.1s ease"}}},children:[t.jsx(n,{sx:{display:"flex",alignItems:"center",justifyContent:"center",p:1,backgroundColor:r.palette.grey[50],borderRadius:1,border:`1px solid ${r.palette.divider}`,position:"sticky",left:0,zIndex:5,minHeight:50},children:t.jsxs(l,{variant:"body2",fontWeight:"bold",children:[e.toString().padStart(2,"0"),":00"]})}),B.map((o,a)=>{var E,z;const i=o.format("YYYY-MM-DD"),s=$(i,e),c=s?k(s.condition):null,R=o.isSame(j(),"day")&&e===j().hour();return t.jsx(te,{title:s?`${o.format("ddd")} ${e}ì‹œ - ${c==null?void 0:c.emoji} ${c==null?void 0:c.label}${s.memo?` - ${s.memo}`:""}`:`${o.format("ddd")} ${e}ì‹œ - ì»¨ë””ì…˜ ê¸°ë¡í•˜ê¸°`,arrow:!0,children:t.jsxs(n,{onClick:()=>F(i,e,s),sx:{minHeight:50,backgroundColor:X(s,a),border:s?`3px solid ${((E=k(s.condition))==null?void 0:E.color)||r.palette.divider}`:`2px solid ${h(a)}20`,borderRadius:2,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",transition:"all 0.2s ease","&:hover":{transform:"scale(1.05)",boxShadow:2,borderColor:s?(z=k(s.condition))==null?void 0:z.color:h(a)},...R&&{boxShadow:`0 0 0 3px ${r.palette.primary.main}40`,borderColor:r.palette.primary.main}},children:[s&&c&&t.jsx(l,{sx:{fontSize:"1.5rem"},children:c.emoji}),R&&t.jsx(n,{sx:{position:"absolute",top:2,right:2,width:8,height:8,backgroundColor:r.palette.primary.main,borderRadius:"50%",animation:"pulse 2s infinite"}}),(s==null?void 0:s.memo)&&t.jsx(n,{sx:{position:"absolute",bottom:2,left:2,width:6,height:6,backgroundColor:r.palette.info.main,borderRadius:"50%"}})]})},`${i}-${e}`)})]},e))]})})]})}),t.jsxs(oe,{open:G,onClose:()=>b(!1),maxWidth:"sm",fullWidth:!0,children:[t.jsx(re,{children:d&&`ì»¨ë””ì…˜ ê¸°ë¡ - ${j(d.date).format("MM/DD")} ${d.hour.toString().padStart(2,"0")}:00`}),t.jsxs(ae,{children:[t.jsx(l,{variant:"subtitle2",gutterBottom:!0,sx:{mt:2},children:"ì»¨ë””ì…˜ì„ ì„ íƒí•˜ì„¸ìš”:"}),t.jsx(se,{variant:"outlined",sx:{mb:3,flexWrap:"wrap"},children:y.map(e=>t.jsxs(p,{onClick:()=>_(e.level),sx:{bgcolor:e.color+"20",borderColor:e.color,color:e.color,"&:hover":{bgcolor:e.color+"30",borderColor:e.color}},children:[e.emoji," ",e.label]},e.level))}),t.jsx(ne,{fullWidth:!0,multiline:!0,rows:3,label:"ë©”ëª¨ (ì„ íƒì‚¬í•­)",placeholder:"ì»¨ë””ì…˜ì— ëŒ€í•œ ìƒì„¸í•œ ê¸°ë¡ì„ ë‚¨ê²¨ë³´ì„¸ìš”...",value:w,onChange:e=>S(e.target.value)})]}),t.jsxs(ie,{children:[t.jsx(p,{onClick:()=>b(!1),children:"ì·¨ì†Œ"}),t.jsx(p,{onClick:L,variant:"contained",children:"ì €ìž¥"})]})]})]})};export{ue as default};
