<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" id="favicon" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ê°œì¸ ë¹„ì„œ ğŸ¤–</title>

    <!-- PWA ë§¤ë‹ˆí˜ìŠ¤íŠ¸ -->
    <link rel="manifest" href="./manifest.json?v=2" />
    <meta name="theme-color" content="#667eea" />
    <meta name="description" content="ë‚˜ë§Œì˜ í­ê·„ ê°œì¸ ë¹„ì„œ ğŸ§ - ì»¨ë””ì…˜ ê´€ë¦¬, í”„ë¡œì íŠ¸ ì¶”ì§„, ë°ì´í„° ë¶„ì„ê¹Œì§€!" />

    <!-- PWA ì§€ì› -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="í­ê·„ ë¹„ì„œ" />
    <link
      rel="apple-touch-icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ§</text></svg>"
    />

    <!-- í…Œë§ˆë³„ favicon ë™ì  ë³€ê²½ -->
    <script>
      function updateFavicon() {
        const theme = localStorage.getItem("selectedTheme") || "penguin";
        const favicon = document.getElementById("favicon");
        const title = document.querySelector("title");

        const themeConfig = {
          penguin: {
            emoji: "ğŸ§",
            title: "í­ê·„ ë¹„ì„œ ğŸ§",
            dataUrl:
              'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">ğŸ§</text></svg>',
          },
          "desert-fox": {
            emoji: "ğŸ¦Š",
            title: "ì‚¬ë§‰ì—¬ìš° ë¹„ì„œ ğŸ¦Š",
            dataUrl:
              'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">ğŸ¦Š</text></svg>',
          },
          sheep: {
            emoji: "ğŸ‘",
            title: "ì–‘ ë¹„ì„œ ğŸ‘",
            dataUrl:
              'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">ğŸ‘</text></svg>',
          },
          cat: {
            emoji: "ğŸ±",
            title: "ê³ ì–‘ì´ ë¹„ì„œ ğŸ±",
            dataUrl:
              'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">ğŸ±</text></svg>',
          },
        };

        const config = themeConfig[theme] || themeConfig.penguin;
        favicon.href = config.dataUrl;
        title.textContent = config.title;
      }

      // í˜ì´ì§€ ë¡œë“œì‹œ ì‹¤í–‰
      document.addEventListener("DOMContentLoaded", updateFavicon);

      // í…Œë§ˆ ë³€ê²½ ê°ì§€ë¥¼ ìœ„í•œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      window.addEventListener("storage", function (e) {
        if (e.key === "selectedTheme") {
          updateFavicon();
        }
      });

      // ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ë¡œë„ ì—…ë°ì´íŠ¸ ê°€ëŠ¥í•˜ê²Œ
      window.addEventListener("themeChanged", updateFavicon);
    </script>

    <!-- Service Worker ë“±ë¡ -->
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("./sw.js")
            .then((registration) => {
              console.log("ğŸ§ SW registered: ", registration);

              // ì—…ë°ì´íŠ¸ í™•ì¸
              registration.addEventListener("updatefound", () => {
                const newWorker = registration.installing;
                if (newWorker) {
                  newWorker.addEventListener("statechange", () => {
                    if (newWorker.state === "installed" && navigator.serviceWorker.controller) {
                      console.log("ğŸ§ ìƒˆ ë²„ì „ ì‚¬ìš© ê°€ëŠ¥! í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤.");
                      window.location.reload();
                    }
                  });
                }
              });

              // ì¦‰ì‹œ ì—…ë°ì´íŠ¸ í™•ì¸
              registration.update();
            })
            .catch((registrationError) => {
              console.log("ğŸ§ SW registration failed: ", registrationError);
            });
        });
      }
    </script>

    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Noto Sans KR", sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      #root {
        height: 100vh;
        width: 100vw;
      }
    </style>
    <script type="module" crossorigin src="/my-penguin/assets/index-c33134b0.js"></script>
  </head>
  <body>
    <div id="root"></div>
    
  </body>
</html>
